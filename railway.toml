# =============================================================================
# Railway Configuration pour ArchiMeuble Backend
# =============================================================================
# Ce fichier configure le déploiement sur Railway
# Documentation: https://docs.railway.app/deploy/config-as-code
# =============================================================================

[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[deploy]
# Commande de démarrage: script qui initialise la DB et lance PHP
startCommand = "bash /app/start.sh"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Health check pour vérifier que l'application est opérationnelle
healthcheckPath = "/backend/api/test.php"
healthcheckTimeout = 30

# Volume persistant pour les uploads, sessions et backups
# La base de données est maintenant sur PostgreSQL (plugin Railway)
# DATABASE_URL est fourni automatiquement par le plugin PostgreSQL
[[deploy.volumes]]
mountPath = "/data"
name = "archimeuble_data_volume"
